---
id: 353
title: 'Миграция VMWare > Hyper-V 3.0 почти без простоя'
date: 2014-03-25T21:26:16+00:00
author: rootilo
layout: post
guid: http://4c74356b41.com/post353
permalink: /post353
categories:
  - random
tags:
  - Copypaste
  - Guide
---
по мотивам <http://www.techdays.ru/videos/6435.html>

1. [Создание на целевом сервере NFS шары](http://virtuallyhyper.com/2012/06/configure-windows-2008-nfs-share-vmware-esx/)
  
2. Регистрация NFS шары в качестве хранилища для ESX/ESXi;
  
3. Миграция хранилища виртуальной машины на NFS шару;
  
4. Создание виртуальной машины на Hyper-V по образу мигрируемой (без виртуальных дисков);
  
5. Удаление VMWare Tools с виртуальной машины и ее выключение;
  
6. Конвертация файлов .vmdk в .vhd с помощью [vhdtool.exe](http://www.techieshelp.com/downloads/VhdTool.exe);
  
7. Смена расширения файлов и подключение их к виртуальной машине на Hyper-V;
  
8. Включение виртуальной машины на Hyper-V.

Опишу еще одну проблему, которая запомнилась мне при миграции виртуальных машин. Связана она с семейством ОС Windows Server 2003. Ввиду некоторых условностей нам приходится использовать эту операционную систему. При создании виртуальной машины в VMWare ESX, мастер предлагает нам по умолчанию использовать SCSI шину для виртуальных дисков, Hyper-V же не приемлет загрузку ОС со SCSI, только IDE. Что происходит когда мы диск с ОС Windows Server 2003, установленной на диск подключенный по SCSI-шине, подключаем к IDE контроллеру Hyper-V и включаем виртуальную машину? Правильно, мы наблюдаем синий экран с ошибкой загрузчика, который не может найти устройство с которого производить загрузку. Решение данной проблемы было тривиальным, хоть и не далось мне так легко. Перед конвертацией дисков, я добавил к виртуальной машине новый диск подключив его к IDE контроллеру. Инициализировав диск, мы тем самым включаем драйвер IDE контроллера в системе.

Это репост [вот отсюда](https://ru.intel.com/business/community/index.php?automodule=blog&blogid=57042&&req=printentry&eid=4056), делаю чтобы всегда было под рукой и не потерялось.