---
id: 593
title: '"–°–µ—Ä–¥—Ü–µ" PDT - Variable.xml (—á–∞—Å—Ç—å 2)'
date: 2014-06-20T12:44:17+00:00
author: rootilo
layout: post
guid: http://4c74356b41.com/post593
permalink: /post593
categories:
  - Azure Pack
  - Virtualization and Cloud
tags:
  - Guide
  - PDT
  - Powershell Deployment Toolkit
  - System Center 2012 R2
  - Windows Azure Pack
---
**–ü—Ä–æ–¥–æ–ª–∂–∏–º –∏–∑—É—á–µ–Ω–∏–µ Variable.xml.**
  
–í –∫–æ–º–ø–ª–µ–∫—Ç–µ PDT –∏–¥—É—Ç 2 Variable.xml —Ñ–∞–π–ª–∞, –æ–¥–∏–Ω –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ AD, –¥—Ä—É–≥–æ–π –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è —Å –Ω—É–ª—è.
  
–ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ, —á—Ç–æ–±—ã –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –æ–¥–∏–Ω –≤ –¥—Ä—É–≥–æ–π –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å (–∏–ª–∏ —É–±—Ä–∞—Ç—å) –∫—É—Å–æ–∫ xml —Ñ–∞–π–ª–∞ –≥–¥–µ –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –¥–æ–º–µ–Ω:

<Domain>
  
<Name>contoso.com</Name>
  
<ServiceAccountOU>Users</ServiceAccountOU>
  
<GroupOU>Groups</GroupOU>
  
</Domain>

–ö–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è VM –º—ã –≤–∫—Ä–∞—Ç—Ü–µ¬†—Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏ –≤ [–ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç–∞—Ç—å–µ](http://4c74356b41.com/post546). –û–±—â–∞—è –∏–¥–µ—è —Ç–∞–∫–æ–≤–∞, –≤—Å–µ —á—Ç–æ –í—ã –Ω–µ —É–∫–∞–∂–∏—Ç–µ –≤ —Å–≤–æ–π—Å—Ç–≤–∞—Ö –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã (–ø–æ—Å–ª–µ —Ç–µ–≥–∞ <VM>) –±—É–¥–µ—Ç –≤–∑—è—Ç–æ –∏–∑ —Ç–µ–≥–∞ <Default>. –ü–∞—Ä—É –ø—Ä–∏–º–µ—Ä–æ–≤.
  
–ï—Å–ª–∏ –∫–∞–∫—É—é-—Ç–æ –º–∞—à–∏–Ω—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–¥–µ–ª–∞—Ç—å –º–∞—à–∏–Ω–æ–π –ø–µ—Ä–≤–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ —Ç–µ–≥–∞ –º–∞—à–∏–Ω—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—Å—Ç–∞–≤–∏—Ç—å "<VMGeneration>1</VMGeneration>". –ù–µ –∑–∞–±—É–¥—å—Ç–µ —É–∫–∞–∑–∞—Ç—å –µ–º—É –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –¥–∏—Å–∫ (—Ç–∫ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã –ø–µ—Ä–≤–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è –Ω–µ –º–æ–≥—É—Ç –≥—Ä—É–∑–∏—Ç—å—Å—è —Å iSCSI):
  
<VM>
  
<VM Count="–Ω–æ–º–µ—Ä">
  
<VMName>–ò–º—è</VMName>
  
<VMGeneration>1</VMGeneration>
  
<OSDisk>
  
<Parent>–ø—É—Ç—å –¥–æ vhd(x)</Parent>
  
<Type>Differencing</Type>
  
</OSDisk>
  
</VM>

–ö–∞–∫ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É –Ω–∞ –¥—Ä—É–≥–æ–º —Ö–æ—Å—Ç–µ:
  
<VM>
  
<VM Count="–Ω–æ–º–µ—Ä">
  
<Host>–∏–º—è —Ö–æ—Å—Ç–∞</Host>
  
</VM>

–°–ª–æ–≤–æ–º \_–≤—Å–µ\_ —á—Ç–æ –∏–¥–µ—Ç –≤–Ω—É—Ç—Ä–∏ —Ç–µ–≥–∞ <Default> –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã.

**–ù–µ–º–Ω–æ–≥–æ –º—ã—Å–ª–µ–π –ø—Ä–æ SQL:**
  
–ï—Å–ª–∏ –í—ã —Ö–æ—Ç–∏—Ç–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∫–∞–∫—É—é-—Ç–æ —Ä–æ–ª—å –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º SQL —Å–µ—Ä–≤–µ—Ä–µ:
  
<Role Name="System Center 2012 R2 Virtual Machine Manager Database Server" Server="VMMDB.contoso.com" Instance="MSSQLSERVER" Existing="True">

–ï—Å–ª–∏ Installer.ps1 –∏–ª–∏ VMCreator.ps1 –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Ä—É–≥–∞—é—Ç—Å—è, —á—Ç–æ –ø–æ—Ä—Ç –Ω–µ –∑–∞–¥–∞–Ω, –µ–≥–æ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –¥–æ–±–∞–≤–∏–≤¬†Port="number" –≤ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–Ω—Å—Ç–∞–Ω—Å–∞:
  
<Instance Server="SQL-01.contoso.com" Instance="MSSQLSERVER" Version="SQL Server 2012&#8243; Port="number">

–ï—Å–ª–∏ –í—ã —Ö–æ—Ç–∏—Ç–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∫–∞–∫—É—é-—Ç–æ —Ä–æ–ª—å –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–µ SQL –í–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –∫ –æ–ø–∏—Å–∞–Ω–∏—é —Ä–æ–ª–∏ SQLCluster="True":
  
<Role Name="System Center 2012 R2 Virtual Machine Manager Database Server" Server="SQL-01.contoso.com" Instance="MSSQLSERVER" SQLCluster="True"></Role>
  
<Role Name="SQL Server 2012 Management Tools" Server="SQL-01.contoso.com" SQLCluster="True"></Role>

–ò —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Ä–æ–ª–∏ SQL:
  
<Cluster Cluster="SQL-01.contoso.com" Version="SQL Server 2012&#8243;
  
<Variable Name="SQLUserDBDir" Value="D:MSSQL11.$InstanceMSSQLData" /> - –∏ –ø–æ–ø—Ä–∞–≤–∏—Ç—å —ç—Ç–∏ –ø—É—Ç–∏ –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–Ω—ã–µ
  
<Variable Name="SQLUserDBLogDir" Value="E:MSSQL11.$InstanceMSSQLData" />
  
<Variable Name="SQLTempDBDir" Value="F:MSSQL11.$InstanceMSSQLData" />
  
<Variable Name="SQLTempDBLogDir" Value="F:MSSQL11.$InstanceMSSQLData" />
  
<Variable Name="SQLClusterIPAddress"
  
<Variable Name="SQLClusterIPAddress" Value=""IP />
  
<Variable Name="SQLClusterNetwork"¬†Value="Cluster Network 1&#8243;¬†/>
  
<Variable Name="SQLClusterSubnet"¬†Value="Subnet"/>
  
<Node Server="FQDN" Preferred "1"></Node>
  
<Node Server="FQDN" Preferred "2"></Node>

–ù–æ —ç—Ç–æ —Ç–æ–ª—å–∫–æ –ø–æ–ª –ø—É—Ç–∏ üòâ
  
–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω, –í–∞–º –Ω—É–∂–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Installer.ps1 –Ω–∞ –¥–æ–º–µ–Ω –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ,—Å–æ–∑–¥–∞—Ç—å —Ä—É–∫–∞–º–∏ Failover Cluster, —Å–æ–∑–¥–∞—Ç—å —Å–µ—Ç–µ–≤—ã–µ —à–∞—Ä—ã –¥–ª—è –Ω–µ–≥–æ, –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å file share witness, –¥–∞—Ç—å –∫–ª–∞—Å—Ç–µ—Ä–Ω–æ–º—É –∞–∫–∫–∞—É–Ω—Ç—É –¥–æ—Å—Ç—É–ø Full Control –≤ OU –∫–ª–∞—Å—Ç–µ—Ä–∞ –∏ –æ–±—ä–µ–∫—Ç—ã –≤ —ç—Ç–æ–º OU (–∏–ª–∏ Full Control –Ω–∞ OU –∏ VCOCNO), –¥–∞—Ç—å –µ–º—É –∏ –∞–∫–∫–∞—É–Ω—Ç—É –∏–Ω—Å—Ç–∞–ª–ª–µ—Ä–∞ –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –Ω–∞ —Å–µ—Ç–µ–≤—ã–µ –∏ –∫–ª–∞—Å—Ç–µ—Ä–Ω—ã–µ "—à–∞—Ä—ã" –∏ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å Installer.ps1 –∑–∞–Ω–æ–≤–æ.

–í —Å–ª—É—á–∞–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ SCOM DB –∏ SCOM DW DB –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∏—Ö –Ω–∞ –æ–¥–Ω—É –∏ —Ç—É¬†–∂–µ –Ω–æ–¥—É –∫–ª–∞—Å—Ç–µ—Ä–∞ (—ç—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ SCOM), –∞ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ä–µ–ø–æ—Ä—Ç–∏–Ω–≥–∞ –Ω–∞ —ç—Ç–æ—Ç –∂–µ SCOM, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å—Ç–∞–≤–∏—Ç—å –µ–≥–æ –Ω–∞ —Ç—É –∂–µ –Ω–æ–¥—É –≥–¥–µ —É–∂–µ¬†–Ω–∞—Ö–æ–¥–∏—Ç—Å—è SCOM Management —Å–µ—Ä–≤–µ—Ä. –¢–µ —É–∫–∞–∑–∞—Ç—å –ø—Ä–æ—Å—Ç–æ —Ç–æ—Ç –∂–µ —Å–µ—Ä–≤–µ—Ä (–Ω–µ –Ω–æ–¥—É –∏ –Ω–µ –∫–ª–∞—Å—Ç–µ—Ä):
  
<Role Name="System Center 2012 R2 Operations Manager Management Server" Server="OM1.contoso.com"></Role>
  
<Role Name="System Center 2012 R2 Operations Manager Reporting Server" Server="OM1.contoso.com" Instance="MSSQLSERVER"></Role>

**–ù–µ—Å–∫–æ–ª—å–∫–æ —Å–ª—É—á–∞–π–Ω—ã—Ö –º—ã—Å–ª–µ–π:**
  
- –ö–ª—é—á "WindowsAzurePack2013ConfigStorePassphrase", –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–¥–∞–Ω–∏—è —Ñ—Ä–∞–∑—ã –ø–∞—Ä–æ–ª—è –≤ Windows Azure Pack, –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç —Å–∏–º–≤–æ–ª–∞ _;
  
- SCCM –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ SQL —Å –≤–∫–ª—é—á–µ–Ω–Ω—ã–º–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –ø–æ—Ä—Ç–∞–º–∏;
  
- –í —Å–ª—É—á–∞–µ –µ—Å–ª–∏ –ø—Ä–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤—ã–¥–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å Variable.xml –∑–∞–≥—Ä—É–∑–∏–≤ –µ–≥–æ –≤ Powershell¬†$Variable = \[XML\] (Get-Content .Variable.xml). Powershell —Å–æ–æ–±—â–∏—Ç –Ω–∞ –∫–∞–∫–æ–π —Å—Ç—Ä–æ–∫–µ –æ—à–∏–±–∫–∞;
  
- –ü—Ä–∏ —É–∫–∞–∑–∞–Ω–∏–∏ NETBIOS –∏–º–µ–Ω–∏ –¥–æ–º–µ–Ω–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–∞—à–∏–Ω, –º–∞—à–∏–Ω—ã –º–æ–≥—É—Ç –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —Ñ–∞–∑—É Specialize –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ –ø—ã—Ç–∞—è—Å—å –≤—Å—Ç—É–ø–∏—Ç—å –≤ –¥–æ–º–µ–Ω;
  
- –í —Å–ª—É—á–∞–µ –ø—Ä–æ–±–ª–µ–º —Å unattend.xml –ø—Ä–æ—â–µ –≤—Å–µ–≥–æ –∏—Å–∫–∞—Ç—å –ø—Ä–∏—á–∏–Ω—ã –Ω–∞ —Å–∞–º–æ–π –≤–∏—Ä—Ç—É–∞–ª–∫–µ –Ω–∞–∂–∞–≤ Shift+F10, –∏ –¥–∞–ª–µ–µ —á–µ—Ä–µ–∑ –±–ª–æ–∫–Ω–æ—Ç. %windir%Panther –∏¬†%windir%PantherUnnatendGC —Ñ–∞–π–ª—ã¬†setupact.log –∏¬†setuperr.log. Unnattend.xml –≤ –ø–∞–ø–∫–µ¬†%windir%Panther;
  
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω –∏–∑ —Ñ–∞–π–ª–∞ Variable.xml —Å –Ω–µ –¥–æ–º–µ–Ω–Ω–æ–π —Ä–∞–±–æ—á–µ–π —Å—Ç–∞–Ω—Ü–∏–∏ –∏ –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–º–µ–Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã –º–æ–≥—É—Ç –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —Ñ–∞–∑—É OOBE –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ –≤ unnattend.xml, –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–¥–Ω–æ–≥–æ –∏–∑ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã,¬†–±—É–¥–µ—Ç —É–∫–∞–∑–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å—Ç–∏–≤—à–∏–π —Å–∫—Ä–∏–ø—Ç, –∏, –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω,–æ –æ–Ω –Ω–µ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω, —Ç–∞–∫ –∫–∞–∫ –Ω–µ –±—É–¥–µ—Ç –Ω–∞–π–¥–µ–Ω. Workaround - –∑–∞—Ç–µ—Ä–µ—Ç—å –∫—É—Å–æ–∫ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–ª—è–µ—Ç —ç—Ç–æ –≤ unattend.xml –≤ —Å–∫—Ä–∏–ø—Ç–µ¬†VMCreator.ps1 (1437 —Å—Ç—Ä–æ–∫–∞, –∫—É—Å–æ–∫ –ø–æ—Å–ª–µ¬†$env:UserDomain -ne $InstallerServiceAccountDomain, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å—Ç–µ—Ä–µ—Ç—å –≤—Å–µ –ø–æ—Å–ª–µ @" –∏ –¥–æ "@):
  
If ($env:UserDomain -ne $InstallerServiceAccountDomain) {
  
@"
  
"@ | Out-File "$Drive\`:unattend.xml" -Append -Encoding ASCII

–í –ø–æ—Å–ª–µ–¥–Ω–µ–º –∏–∑ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤ —è —Ä–∞—Å—Å–∫–∞–∂—É –≤ –æ–±—â–µ–º –æ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è¬†–∏ –ø–æ–¥–∫–∏–Ω—É –µ—â–µ –ø–∞—Ä—É –º—ã—Å–ª–µ–π –Ω–∞ —Ç–µ–º—É PDT.

–ü–°. –ù–∞—Ç–∫–Ω—É–ª—Å—è —Ç—É—Ç –Ω–∞ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –ø–æ—Å—Ç –æ PDT.¬†[–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ä–µ–¥—ã –¥–ª—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö —Ä–∞–±–æ—Ç](http://social.technet.microsoft.com/wiki/contents/articles/22048.creating-system-center-vms-using-pdt-for-hybrid-scenario.aspx)¬†–ø–æ –≥–∏–±—Ä–∏–¥–Ω–æ–º—É –æ–±–ª–∞–∫—É¬†(<a href="http://aka.ms/hybridlabs" target="_blank">http://aka.ms/hybridlabs</a>).